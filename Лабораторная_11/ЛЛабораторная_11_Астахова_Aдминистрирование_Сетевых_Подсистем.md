**РОССИЙСКИЙ УНИВЕРСИТЕТ ДРУЖБЫ**

> **НАРОДОВ**

**Факультет физико-математических и естественных**

**наук**

**Кафедра теории вероятностей и кибербезопасности**

**Отчет лабораторной работы 11**

**Дисциплина:** Администрирование сетевых подсистем

Студент: Астахова Марина

Группа: НПИбд-02-23

***Тема: Настройка безопасного удалённого***

> ***доступа по протоколу SSH***

***1***

***1.1. Цель работы.***

Приобретение практических навыков по настройке удалённого доступа к

серверу с помощью SSH.

***1***

***1.2. Выполнение работы***

**1**

**1.2.1. Запрет удалённого доступа по SSH для пользователя**

**root**

Перехожу в режим суперпользователя и ввожу пароль

На сервере в дополнительном терминале запускаю мониторинг системных

событий:

С клиента попытаюсь получить доступ к серверу посредством SSH-

соединения через пользователя root:

Так как сервис не найден, на сервере откройте файл /etc/ssh/sshd_config

конфигурации sshd для редактирования и запретите вход на сервер

пользователю root, установив:

Перезапускаю sshd

Повторяю попытку:

**Итог:** Результат такой же.

**1**

**1.2.2. Ограничение списка пользователей для удалённого**

**доступа по SSH**

Опять попытаюсь - тот же итог.

В файле конфигурации добавляю строку:

**1**

**1.2.3. Настройка дополнительных портов для удалённого**

**доступа по SSH**

На сервере в файле конфигурации sshd /etc/ssh/sshd_config

нахожу строку Port и ниже этой строки добавляю:

Исправлю на сервере метки SELinux к порту 2022:

С клиента попытаюсь получить доступ к серверу посредством SSH-

соединения

**1**

**1.2.4. Настройка удалённого доступа по SSH по ключу**

На сервере в конфигурационном файле /etc/ssh/sshd_config задаю

параметр, разрешающий аутентификацию по ключу:

На клиенте сформирую SSH-ключ:

**1**

**1.2.5. Организация туннелей SSH, перенаправление TCP-**

**портов**

Перенаправляю порт 80 на server.user.net на порт 8080 на локальной

машине

**Итог: туннель работает.**

**1**

**1.2.6. Запуск консольных приложений через SSH**

Посмотрю с клиента почту на сервере

**1**

**1.2.7. Запуск графических приложений через SSH**

**(X11Forwarding)**

На сервере в конфигурационном файле /etc/ssh/sshd_config разрешу

отображать на локальном клиентском компьютере графические

интерфейсы X11:

**1**

**1.2.8. Внесение изменений в настройки внутреннего**

**окружения виртуальной машины**

Вношу изменения в vagrantfile и завожу файл ssh.sh

***1***

***1.3. Итог работы***

**1**

**. Безопасная базовая конфигурация:**

1

. Настроено ограничение доступа по SSH для пользователей:

> доступ для пользователя root был запрещён, а для пользователя
>
> alice --- разрешён через параметры PermitRootLogin no и
>
> AllowUsers alice в файле /etc/ssh/sshd_config.

2

> . Отработана процедура применения изменений конфигурации с

перезапуском службы sshd и проверкой корректности настроек.

**2**

**. Расширенные возможности доступа:**

1

2

. Освоена настройка SSH-сервера для работы на нескольких портах

> (22, 2222, 2022) одновременно, что позволяет обходить сетевые
>
> ограничения и повышает гибкость управления доступом.

. Поняты практические сценарии использования нескольких

> портов: обход блокировок, распределение доступа, снижение
>
> видимости для автоматических атак.

**3**

**. Туннелирование и переадресация портов:**

1

2

. Приобретён навык создания SSH-туннелей с использованием

> ключей -f (фоновый режим) и -N (без выполнения команд), что
>
> позволяет организовывать безопасные соединения для других
>
> приложений.

. Отработана техника локальной переадресации портов на примере

> перенаправления локального порта 5555 на порт 80 удалённого
>
> сервера через SSH-шлюз.

**4**

**. Интеграция с системами безопасности:**

1

2

. Освоена настройка SELinux для разрешения SSH-серверу

> использовать нестандартные порты (2022) через управление
>
> политиками портов с помощью утилиты semanage.

. Приобретён практический опыт настройки межсетевого экрана

> (firewalld, iptables, ufw) для открытия необходимых SSH-портов, что
>
> обеспечивает корректную работу службы в защищённой сетевой
>
> среде.

**5**

**. Комплексное понимание безопасности:**

1

2

. Сформировано комплексное представление о многоуровневой

> защите SSH-доступа: на уровне конфигурации службы, систем
>
> разграничения доступа SELinux и сетевых фильтров.

. Освоен процесс диагностики и проверки работоспособности всех

> компонентов: проверка открытых портов, анализ логов,
>
> тестирование подключений.

**Вывод:** В ходе работы были получены системные знания и практические

умения по развёртыванию безопасного удалённого доступа через SSH, что

позволяет эффективно администрировать серверы, обеспечивая при этом

необходимый уровень защиты от несанкционированного доступа.

Приобретённые навыки являются фундаментальными для системного

администратора и DevOps-инженера.

***1***

***1.4. Контрольные вопросы***

**1**

**. Как запретить удалённый доступ по SSH для пользователя**

**root и разрешить доступ пользователю alice**

Открываю файл конфигурации SSH-сервера /etc/ssh/sshd_config в

текстовом редакторе. Нахожу и изменяю параметр PermitRootLogin,

устанавливаю его значение в no. Затем добавляю строчку AllowUsers alice,

чтобы разрешить доступ только пользователю alice. Сохраняю файл и

перезапускаю службу SSH для применения изменений. Теперь

подключиться по SSH под root напрямую будет невозможно, а пользователь

alice получит доступ.

**2**

**. Как настроить удалённый доступ по SSH через несколько**

**портов и зачем это нужно**

Редактирую тот же конфигурационный файл SSH. В разделе с портами

указываю несколько значений через отдельные строки Port, например Port

2

2,

Port

2222,

Port

2022\.

После сохранения и перезапуска службы SSH открываю эти

дополнительные порты в настройках межсетевого экрана.

Это может потребоваться для нескольких целей: чтобы обойти блокировку

стандартного порта 22 в некоторых сетях, чтобы снизить количество

автоматических атак на стандартный порт, для разделения доступа ---

например, один порт для администраторов, другой для обычных

пользователей, или для тестирования новых конфигураций без риска

потерять основное подключение.

**3**

**. Какие параметры SSH используются для создания туннеля**

**в фоновом режиме без выполнения команд**

Для создания такого туннеля использую ключ -f, который переводит SSH-

соединение в фоновый режим после успешной аутентификации, и ключ -N,

который указывает, что не нужно выполнять никакую удалённую команду

---

нужно только установить соединение для туннелирования. Основной

ключ для туннеля, например -L для локальной переадресации, задаётся

вместе с ними.

**4**

**. Как настроить локальную переадресацию с локального**

**порта 5555 на порт 80 сервер[а](https://server2.example.com/)**
**[[server2.example.com](https://server2.example.com/)]{.underline}**

Выполняю в терминале команду SSH, используя ключ -L с указанием

локального порта, адреса целевого сервера и его порта. Полная команда

выглядиттак: **ssh -L 5555: server2.example.com: 80**

**имя_пользователя@промежуточный_сервер.** Если нужно, чтобы

соединение ушло в фон, добавляю **-f -N**. Теперь, обращаясь на своём

компьютере к l**ocalhost:5555**, трафик будет безопасно перенаправляться

через SSH-соединение на порт 80 сервера **server2.example.com.**

**5**

**. Как настроить SELinux, чтобы разрешить SSH работать с**

**портом 2022**

Сначала проверяю, какие порты уже разрешены для SSH в политиках

SELinux с помощью команды semanage. Затем добавляю новый порт 2022

в контекст безопасности ssh_port_t с помощью команды semanage port -a.

Это говорит SELinux, что службе SSH разрешено слушать и использовать

порт 2022. После применения изменений перезапускаю службу SSH, и она

сможет работать с этим портом.

**6**

**. Как настроить межсетевой экран для разрешения входящих SSH-**

**подключений на порт 2022**

В зависимости от системы, использую соответствующий инструмент. В

системах с firewalld добавляю порт 2022 протокола TCP в постоянные

правила и затем перезагружаю конфигурацию фаервола. В системах с ufw

просто выполняю команду разрешения для этого порта. В системах с

классическим iptables добавляю правило в цепочку INPUT, разрешающее

новые и установленные соединения на порт 2022, и сохраняю правила.

После настройки проверяю, что порт открыт и служба SSH на нём

слушает.
