**РОССИЙСКИЙ УНИВЕРСИТЕТ ДРУЖБЫ**

> **НАРОДОВ**

**Факультет физико-математических и естественных**

**наук**

**Кафедра теории вероятностей и кибербезопасности**

**Отчет лабораторной работы 2**

**Дисциплина:** Администрирование сетевых подсистем

Студент: Астахова Марина

Группа: НПИбд-02-23

***Тема:*** Настройка DNS-сервера

***2***

***.1. Цель работы.***

Приобретение практических навыков по установке и конфигурированию

DNS сервера, усвоение принципов работы системы доменных имён.

***2***

***.2. Выполнение работы***

1

. Установка DNS-сервера

Включаем виртуальную машину и вводим логин

Установка bind и bind-utils:

В качестве упражнения с помощью утилиты dig сделали запрос к DNS

адресу www.yandex.ru:

*2*

*. Конфигурирование кэширующего DNS-сервера*

**2**

**.1 Запустим сервер**

**2**

**.2 Проанализируем в отчёте отличие в выведенной на экран**

**информации при выполнении команд**

**2**

**.3 Сделаем DNS-сервер сервером по умолчанию для хоста server и**

**внутренней виртуальной сети. Для этого требуется изменить**

**настройки сетевого соединения eth0 в NetworkManager, переключив**

**его на работу с внутренней сетью и указав для него в качестве DNS-**

**сервера по умолчанию адрес 127.0.0.1:**

**2**

**.4 Сделаем то же самое для соединения System eth0 (если оно**

**активно):**

**2**

**.5 Проверим изменения в resolv.conf**

(При настройке dns я исправляла этот файл и сейчас он выглядит по

другому)

**2**

**.6 Настройка направление DNS-запросов от всех узлов внутренней**

**сети, включая запросы от узла server, через узел server.**

**2**

**.7 Внесем изменения в настройки межсетевого экрана узла server,**

**разрешив работу с DNS:**

**2**

**.8 Убедитесь, что DNS-запросы идут через узел server, который**

**прослушивает порт 53. Для этого на данном этапе используйте**

**команду lsof:**

2

.4.2.2. Конфигурирование кэширующего DNS-сервера

при наличии фильтрации DNS-запросов

маршрутизаторами

*3*

*. Конфигурирование кэширующего DNS сервера при*

*наличии фильтрации DNS-запросов маршрутизаторами*

Посмотрим на содержание файла resolv.conf и добавить в список в

named.conf

Кроме того, возможно вышестоящий DNS-сервер может не поддерживать

технологию DNSSEC, тогда следует в конфигурационном файле

named.conf указать следующие настройки:

Но из-за того, что у меня все работает и без дополнительных настроек, то

я комментирую эти записи.

*4*

*. Конфигурирование первичного DNS-сервера*

1

. Скопировали шаблон описания DNS-зон named.rfc1912.zones из

каталога /etc в каталог /etc/named и переименовали его в astakhovamd.net
:

2

. Включили файл описания зоны /etc/named/user.net в конфигурационном

файле DNS /etc/named.conf, добавив в нём в конце строку:

3

. Открыли файл /etc/named/astakhovamd.net и прописали:

4

. В каталоге /var/named создали подкаталоги master/fz и master/rz, в

которых будут располагаться файлы прямой и обратной зоны

соответственно:

5

. Скопировали шаблон прямой DNS-зоны named.localhost из каталога

/

var/named в каталог /var/named/master/fz и переименовали файл

6

. Изменим файл /var/named/master/fz/astakhovamd.net, указав

необходимые DNS-записи для прямой зоны.

7

. Скопировали шаблон обратной DNS-зоны named.loopback из каталога

/

var/named в каталог /var/named/master/rz и переименовали его в
192.168.1:

8

. Изменили файл /var/named/master/rz/192.168.1, указав необходимые

DNS-записи для обратной зоны.

9

. Далее требуется исправить права доступа к файлам и восстановить их

метки в SELinux:

1

0\. Для проверки состояния переключателей SELinux, относящихся к

named, введем:

1

1\. Во дополнительном терминале запустим в режиме реального времени

расширенный лог системных сообщений, чтобы проверить корректность

работы системы:

Исправили файлы и получилось запустить

5

. Анализ работы DNS-сервера

6

. Внесение изменений в настройки внутреннего окружения

виртуальной машины

Создание файла dns.sh

Добавляем изменения в vagrantfile

*Ответы на вопросы*

**1**

**. Что такое DNS?**

DNS (Domain Name System) - это распределенная система доменных имен,

которая преобразует понятные человеку доменные имена (например,

google.com) в IP-адреса (например, 172.217.160.142), которые компьютеры

используют для идентификации друг друга в сети. DNS работает как

телефонная книга для Интернета.

**2**

**. Каково назначение кэширующего DNS-сервера?**

Кэширующий DNS-сервер (также называемый рекурсивным DNS-

сервером) хранит ответы на DNS-запросы в своей памяти (кэше). Когда

клиент запрашивает разрешение доменного имени, кэширующий сервер

сначала проверяет, есть ли ответ в его кэше. Если есть, он возвращает
этот

ответ клиенту, не обращаясь к другим DNS-серверам. Это значительно

ускоряет процесс разрешения имен и снижает нагрузку на корневые и

авторитативные DNS-серверы.

**3**

**. Чем отличается прямая DNS-зона от обратной?**

•

**Прямая DNS-зона:** Отображает доменные имена в IP-адреса. Например,

она преобразует [[www.example.com]{.underline}](http://www.example.com/)
в 192.0.2.1. • **Обратная DNS-зона:**

Отображает IP-адреса в доменные имена. Например, она преобразует

1

92.0.2.1 в [[www.example.com]{.underline}.](http://www.example.com/)
[И](http://www.example.com/)спользуется для обратного DNS-поиска

(reverse DNS lookup) или rDNS, часто применяемого для проверки

подлинности и предотвращения спама.

**4**

**. В каких каталогах и файлах располагаются настройки DNS-**

**сервера? Кратко охарактеризуйте, за что они отвечают.**

В Linux (и других Unix-подобных системах) с использованием BIND9

(наиболее распространенный DNS-сервер) обычно используется

следующая структура:

•

**/etc/bind/**: Основной каталог конфигурации BIND. \* **named.conf**:

Главный конфигурационный файл BIND. Содержит общие параметры

сервера, определения зон, параметры журналирования и т.д.

\*

**named.conf.options**: Определяет глобальные опции DNS-сервера, такие

как рекурсия, перенаправление запросов (forwarders), списки контроля

доступа (ACL).

\*

**named.conf.local**: Определяет локальные зоны (прямые и обратные).

\*

**named.conf.default-zones**: Определяет стандартные корневые зоны,

необходимые для разрешения доменных имен.

\*

**db.example.com, db.192.0.2**: Файлы зон. Содержат записи ресурсов (RR)

для конкретных доменов и подсетей. Например, db.example.com - записи

для зоны example.com, а db.192.0.2 - для обратной зоны 192.0.2.in-

addr.arpa.

•

**/var/cache/bind/**: Директория, где хранятся файлы зон.

**5**

**. Что указывается в файле resolv.conf?**

Файл /etc/resolv.conf содержит информацию о DNS-серверах, которые

клиентская система должна использовать для разрешения доменных имен.

Обычно включает:

•

nameserver \<IP-адрес\>:

> Указывает IP-адрес DNS-сервера. Можно указать несколько серверов,

которые будут использоваться по порядку.

•

> domain \<имя_домена\>:

Устанавливает локальный домен для поиска неполных доменных имен.

> search \<список_доменов\>:

Устанавливает список доменов для поиска неполных доменных имен.

•

**6**

**. Какие типы записи описания ресурсов есть в DNS и для чего они**

**используются?**

Некоторые из наиболее распространенных типов записей ресурсов

(Resource Records - RR) в DNS:

•

**A (Address record):** Отображает доменное имя в IPv4-адрес.

•

**AAAA (Address record IPv6):** Отображает доменное имя в IPv6-адрес.

•

**CNAME (Canonical Name record):** Создает псевдоним для доменного

имени. Наприм[ер,](http://www.example.com/)
[[www.example.com]{.underline}](http://www.example.com/) может быть
CNAME для

example.com.

•

**MX (Mail eXchange record):** Указывает почтовый сервер, отвечающий за

прием электронной почты для домена. Содержит приоритет для

определения порядка использования серверов.

•

**NS (Name Server record):** Указывает авторитативный DNS-сервер для

домена.

•

**PTR (Pointer record):** Отображает IP-адрес в доменное имя

(используется в обратных зонах).

•

**SOA (Start of Authority record):** Определяет параметры зоны, такие
как

главный DNS-сервер, адрес электронной почты администратора и

параметры обновления зоны.

•

**TXT (Text record):** Содержит произвольный текст. Используется для

различных целей, таких как проверка домена (SPF, DKIM).

•

**SRV (Service record):** Определяет местоположение служб (например,

LDAP, SIP) по домену.

**7**

**. Для чего используется домен in-addr.arpa?**

Домен in-addr.arpa используется для обратных DNS-зон для IPv4-адресов.

IP-адрес записывается в обратном порядке, а затем добавляется к домену

in-addr.arpa. Например, для IP-адреса 192.0.2.1 будет создана запись PTR
в

зоне 2.0.192.in-addr.arpa.

**8**

**. Для чего нужен демон named?**

named (name daemon) - это демон DNS-сервера BIND (Berkeley Internet

Name Domain). Это основная программа, которая отвечает за обработку

DNS-запросов, управление зонами, кэширование ответов и

взаимодействие с другими DNS-серверами.

**9**

**. В чем заключаются основные функции slave-сервера и master-**

**сервера?**

•

**Master-сервер (Primary DNS server):** Хранит основную копию DNS-

зоны и отвечает за внесение изменений в эту зону.

•

**Slave-сервер (Secondary DNS server):** Получает копию DNS-зоны с

master-сервера и использует ее для ответа на DNS-запросы. Slave-серверы

обеспечивают избыточность и повышают доступность DNS-сервиса.

Slave-серверы обновляют свои зоны с master-сервера через механизм zone

transfer.

**1**

**0. Какие параметры отвечают за время обновления зоны?**

Параметры, контролирующие обновление зоны, обычно находятся в

записи SOA (Start of Authority):

•

**serial:** Серийный номер зоны. Slave-серверы используют этот номер,

чтобы определить, нужно ли обновлять зону. Каждый раз, когда в зону

вносятся изменения, серийный номер должен быть увеличен.

•

**refresh:** Как часто slave-сервер должен проверять у master-сервера,

изменился ли серийный номер зоны.

•

**retry:** Если slave-сервер не может связаться с master-сервером при

обновлении, как часто он должен пытаться повторить.

•

**expire:** Если slave-сервер не может связаться с master-сервером в

течение этого времени, он должен прекратить отвечать на запросы для

этой зоны.

•

**minimum (negative cache TTL):** Как долго кэширующие серверы

должны кэшировать отрицательные ответы (например, \"домен не

существует\").

**1**

**1. Как обеспечить защиту зоны от скачивания и просмотра?**

•

**Списки контроля доступа (ACLs):** Определите ACL в

named.conf.options для ограничения доступа к DNS-серверу. Например,

можно разрешить zone transfer только доверенным slave-серверам.

•

**Разрешить zone transfer только для slave-серверов:** В конфигурации

зоны укажите, каким серверам разрешено запрашивать zone transfer.

Пример: allow-transfer { slave1_ip; slave2_ip; };

•

**DNSSEC (DNS Security Extensions):** DNSSEC добавляет

криптографические подписи к DNS-записям, чтобы предотвратить

подделку и гарантировать целостность данных.

•

**Отключить рекурсию для внешних клиентов (если это**

**авторитативный сервер):** Если DNS-сервер является авторитативным (а

не рекурсивным), отключите рекурсию для запросов из внешних сетей,

чтобы предотвратить его использование для DDoS-атак.

**1**

**2. Какая запись RR применяется при создании почтовых серверов?**

Запись **MX (Mail eXchange)** используется для указания почтовых

серверов, принимающих почту для домена. MX-запись содержит имя

почтового сервера и приоритет (число), определяющий порядок

использования серверов.

**1**

**3. Как протестировать работу сервера доменных имён?**

•

**nslookup:** Интерактивный инструмент для запроса DNS-серверов.

Позволяет запрашивать различные типы записей для доменных имен.

Пример: nsl[ookup](http://www.example.com/)
[[www.example.com](http://www.example.com/)]{.underline}

•

**dig (domain information groper):** Более мощный инструмент, чем

nslookup, для запроса DNS-серверов. Позволяет выполнять более сложные

запросы и анализировать ответы.

•

**TXT (Text record):** Содержит произвольный текст. Используется для

различных целей, таких как проверка домена (SPF, DKIM).

•

**SRV (Service record):** Определяет местоположение служб (например,

LDAP, SIP) по домену.

•

**ping:** Хотя ping обычно используется для проверки доступности хоста,

его можно использовать для проверки разрешения имен. Если ping

работает с доменным именем, это означает, что DNS работает правильно.

•

**Проверка файла /etc/resolv.conf:** Убедитесь, что файл
/etc/resolv.conf

содержит правильные IP-адреса DNS-серверов.

**1**

**4. Как запустить, перезапустить или остановить какую-либо службу**

**в системе?**

В современных Linux-системах (с использованием systemd) используется

команда systemctl:

•

**Запустить:** sudo systemctl start \<имя_службы\> (например, sudo
systemctl

start named)

•

**Перезапустить:** sudo systemctl restart \<имя_службы\> (например, sudo

systemctl restart named)

•

**Остановить:** sudo systemctl stop \<имя_службы\> (например, sudo

systemctl stop named)

•

**Посмотреть статус:** sudo systemctl status \<имя_службы\> (например,

sudo systemctl status named)

•

**Включить автозапуск при загрузке системы:** sudo systemctl enable

\<

имя_службы\> (например, sudo systemctl enable named)

•

**Отключить автозапуск при загрузке системы:** sudo systemctl disable

\<

имя_службы\> (например, sudo systemctl disable named)

**1**

**5. Как посмотреть отладочную информацию при запуске какого-либо**

**сервиса или службы?**

•

**Журналы systemd:** journalctl -u \<имя_службы\> (например, journalctl
-u

named). Эта команда покажет журналы для указанной службы. Можно

использовать опции, такие как -f для отслеживания в реальном времени, -n

\<

количество_строк\> для просмотра последних строк.

•

**Проверить вывод службы при запуске вручную:** Иногда полезно

запустить службу вручную из командной строки, чтобы увидеть любые

ошибки или отладочные сообщения. Это может потребовать знания

исполняемого файла службы и его параметров.

•

**Использовать отладочные параметры службы:** Некоторые службы

имеют параметры командной строки или конфигурационные опции для

включения отладочного режима. Проверьте документацию службы.

**1**

**6. Где хранится отладочная информация по работе системы и служб?**

**Как ее посмотреть?**

В современных Linux-системах используется systemd-journald для ведения

системных журналов. Журналы хранятся в бинарном формате. Основные

способы просмотра журналов:

•

**journalctl:** Основная команда для просмотра журналов.

\*

journalctl: Показать все журналы.

\*

journalctl -b: Показать журналы с текущей загрузки.

> journalctl -u \<имя_службы\>: Показать журналы для указанной службы.

journalctl -f: Отслеживать журналы в реальном времени.

journalctl -n \<количество_строк\>: Показать последние N строк. \*

\*

\*

\*

journalctl \--since \"YYYY-MM-DD HH:MM:SS\": Показать журналы с

указанной даты и времени.

•

**/var/log/**: Некоторые службы все еще могут вести текстовые логи в

каталоге /var/log/.

**1**

**7. Как посмотреть, какие файлы использует в своей работе тот или**

**иной процесс? Приведите несколько примеров.**

Использовать команду lsof (List Open Files) или proc filesystem:

•

**lsof:** \* sudo lsof -p : Показать файлы, открытые процессом с
указанным

PID (Process ID). Например, sudo lsof -p 1234.

\*

sudo lsof -c \<имя_команды\>: Показать файлы, открытые процессами с

указанным именем команды. Например, sudo lsof -c named.

•

**/proc//fd:** Каталог /proc//fd содержит символические ссылки на файлы,

открытые процессом с указанным PID.

ChatGPT4 \| Midjourney, \[25.09.2025 15:04\]

**1**

**8. Приведите несколько примеров по изменению сетевого соединения**

**при помощи командного интерфейса nmcli.**

nmcli (NetworkManager Command Line Interface) - это инструмент

командной строки для управления сетевыми соединениями в Linux.

Примеры:

1

> . Показать список сетевых соединений:

nmcli con show

> . Подключиться к Wi-Fi сети:

2

nmcli dev wifi connect \<имя_сети\> password \<пароль\>

**1**

**9. Что такое SELinux?**

SELinux (Security-Enhanced Linux) - это модуль безопасности ядра Linux,

обеспечивающий принудительный контроль доступа (Mandatory Access

Control - MAC). Он позволяет определять политику безопасности, которая

контролирует доступ процессов к файлам, каталогам, сетевым ресурсам и

другим процессам. SELinux выходит за рамки традиционной

дискреционной модели контроля доступа (DAC), основанной на UID/GID.

**2**

**0. Что такое контекст (метка) SELinux?**

Контекст SELinux (также называемый меткой) - это атрибут, который

присваивается каждому процессу, файлу, каталогу и сетевому ресурсу в

системе. Контекст SELinux состоит из трех основных частей:

•

user: Идентификатор пользователя SELinux.

> role: Роль, которую выполняет процесс или ресурс.
>
> type: Тип процесса или ресурса.

•

•

**2**

**1. Как восстановить контекст SELinux после внесения изменений в**

**конфигурационные файлы?**

Используйте команду restorecon:

sudo restorecon -v \<путь_к_файлу_или_каталогу\>

**2**

**2. Как создать разрешающие правила политики SELinux из файлов**

**журналов, содержащих сообщения о запрете операций?**

Найдите сообщения о запрете (AVC messages) в журналах: Используйте

journalctl или grep для поиска сообщений AVC (Access Vector Cache) в

журналах. AVC messages указывают на то, что SELinux заблокировал

операцию.

**2**

**3. Что такое булевый переключатель в SELinux?**

Булевы переключатели (SELinux booleans) - это переменные, которые

позволяют изменять поведение политики SELinux во время работы

системы без необходимости перекомпилировать или перезагружать всю

политику. Булевы переключатели можно включать или выключать, чтобы

разрешать или запрещать определенные действия. Они предоставляют

гибкий способ настройки SELinux для конкретных потребностей.

**2**

**4. Как посмотреть список переключателей SELinux и их состояние?**

Используйте команду getsebool: getsebool -a

**2**

**5. Как изменить значение переключателя SELinux?**

Используйте команду setsebool:

> Включить переключатель: sudo setsebool \<имя_переключателя\> 1

•

***2***

***.3. Итог работы***

Были приобретены практические навыки по установке и

конфигурированию DNS сервера.
