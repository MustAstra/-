**РОССИЙСКИЙ УНИВЕРСИТЕТ ДРУЖБЫ**

> **НАРОДОВ**

**Факультет физико-математических и естественных**

**наук**

**Кафедра теории вероятностей и кибербезопасности**

**Отчет лабораторной работы 13**

**Дисциплина:** Администрирование сетевых подсистем

Студент: Астахова Марина

Группа: НПИбд-02-23

***Тема: Настройка NFS***

***1***

***3.1. Цель работы.***

Приобретение навыков настройки сервера NFS для

удалённого доступа к ресурсам.

***1***

***3.2. Выполнение работы***

**1**

**3.2.1. Настройка сервера NFSv4**

На сервере создаем каталог - корень дерева NFS

В файле пропишу общий каталог с доступом(только чтение) и задаю

контекст безопасности NFS

Применяю сохранённую настройку

Так как у меня была ограничена память для загрузки пакетов, пришлось

прописать настройки и установку в отдельном файле

Теперь запускаю сервис NFS

Настраиваю межсетевой экран для данной службы

Для установки утилит временно сменяю с локального окружения на

глобальное

Через запрос посмотрим на подмонтированные удаленные ресурсы

Теперь я посмотрю, какие сервисы задействованы:

Добавляю службы rpc-bind в настройки межсетевого экрана

Проверяю подключение удаленного ресурса

**1**

**3.2.2. Монтирование NFS на клиенте**

На клиенте создаю каталог

Подмонтирую дерево NFS

**1**

**3.2.3. Подключение каталогов к дереву NFS**

**На сервере создала каталог и подмонтировала**

**каталог web-сервера**

Добавляю экспорт каталога веб-сервера

Вношу изменения и экспортирую каталоги.

**1**

**3.2.4. Подключение каталогов для работы пользователей**

Создаю каталог с полными правами доступа для пользователя

Подмонтирую каталог

Повторно экспортирую каталог

Перехожу в каталог и завожу файл

**1**

**3.2.5. Внесение изменений в настройки внутреннего**

**окружения виртуальных машин**

Создаю и вписываю скрипт для файла nfs.sh

Создаю для клиента nfs.sh

Добавляю запись в vagrant

***1***

***3.3. Итог работы***

В ходе выполнения работы были успешно приобретены и отработаны

ключевые навыки развёртывания и настройки сетевой файловой системы

NFS для обеспечения удалённого доступа к общим ресурсам в Linux-

среде.

**1**

**. Освоение архитектуры и принципов работы NFS:**

1

2

3

. Изучены различия между версиями протокола NFSv3 и NFSv4, их

преимущества и ограничения.

. Понят механизм работы служб: nfs server, rpcbind, mountd, lockd,

statd.

. Усвоены концепции экспорта каталогов, монтирования и

управления правами доступа.

**2**

**. Практическая настройка NFS-сервера:**

Отработана настройка основного конфигурационного файла /etc/exports:

1

2

3

. Определение экспортируемых каталогов.

. Настройка прав доступа для конкретных клиентов или сетей.

. Использование параметров: ro/rw, sync/async,

no_root_squash/root_squash, subtree_check.

**3**

**. Настройка сетевой безопасности и брандмауэра:**

1

> . Определены и открыты необходимые порты в firewalld:

a\. firewall-cmd \--permanent \--add-service={nfs,nfs3,rpc-

> bind,mountd}

b\. firewall-cmd --reload

2

> . Настроены правила SELinux для NFS-сервера и экспортируемых

каталогов.

3

. Обеспечена безопасность через ограничение доступа по IP-адресам в

> etc/exports.

/

**4**

**. Конфигурация NFS-клиента**

Отработано ручное монтирование ресурсов.

**5**

**. Управление службами и диагностика:**

Отработаны команды управления службами NFS

**6**

**. Решение типовых проблем:**

1

2

3

. Устранение ошибок монтирования при недоступности сервера.

. Настройка правильных прав доступа к файлам.

. Диагностика и исправление проблем с брандмауэром и SELinux.

**7**

**. Обеспечение отказоустойчивости и производительности:**

1

2

. Изучены опции повышения надёжности: hard/soft монтирование,

настройка таймаутов.

. Оптимизация параметров для конкретных сценариев использования

(файловые хранилища, домашние каталоги, общие данные).

***1***

***3.4. Контрольные вопросы***

**1**

**. Как называется файл конфигурации, содержащий общие**

**ресурсы NFS?**

Основной файл конфигурации, содержащий список общих ресурсов

(экспортируемых каталогов) на сервере NFS, называется /etc/exports.

В этом файле указывается, какие локальные директории доступны для

монтирования по сети, а также параметры доступа, разрешённые клиенты

и их права (только чтение, чтение/запись и другие опции).

**2**

**. Какие порты должны быть открыты в брандмауэре, чтобы**

**обеспечить полный доступ к серверу NFS?**

Для полной работы NFSv4 в RHEL 7 и более новых версиях достаточно

открыть порт 2049/TCP (и 2049/UDP для совместимости).

Однако для NFSv3 и для работы со службами, связанными с блокировками

и статусом, могут потребоваться дополнительные порты. В современных

системах используется rpcbind и динамические порты, поэтому

рекомендуется открыть:

Основные порты:

1

2

. 2049/tcp и 2049/udp --- основной порт NFS (достаточно для NFSv4)

. 111/tcp и 111/udp --- порт rpcbind (portmapper)

Для совместимости с NFSv3 и дополнительными службами:

1

2

3

. 20048/tcp и 20048/udp --- служба mountd

. 2048/tcp и 2048/udp --- служба nlockmgr (lockd)

. 2049/tcp и 2049/udp --- служба status (statd)

**3**

**. Какую опцию следует использовать в /etc/fstab, чтобы**

**убедиться, что общие ресурсы NFS могут быть установлены**

**автоматически при перезагрузке?**

В файле /etc/fstab для ресурсов NFS используется опция \_netdev.

Эта опция указывает системе, что данная файловая система является

сетевой, и её монтирование должно происходить только после того, как

сетевое подключение будет установлено.

Ключевые моменты:

1

2

. \_netdev --- гарантирует, что система не будет пытаться смонтировать

ресурс до запуска сети.

. Без этой опции система может зависнуть при загрузке, если NFS-

сервер недоступен.

3

. Для NFSv4 можно использовать опцию nfs4 вместо nfs.

4

. Дополнительные полезные опции:

> soft (мягкое монтирование), timeo= (таймаут),
>
> retrans= (количество повторов).
