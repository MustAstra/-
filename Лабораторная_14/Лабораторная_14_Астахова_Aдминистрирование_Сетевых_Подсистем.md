**РОССИЙСКИЙ УНИВЕРСИТЕТ ДРУЖБЫ**

> **НАРОДОВ**

**Факультет физико-математических и естественных**

**наук**

**Кафедра теории вероятностей и кибербезопасности**

**Отчет лабораторной работы 14**

**Дисциплина:** Администрирование сетевых подсистем

Студент: Астахова Марина

Группа: НПИбд-02-23

***Тема: Настройка файловых служб Samba***

***1***

***4.1. Цель работы.***

Приобретение навыков настройки доступа групп пользователей к общим

ресурсам по протоколу SMB.

***1***

***4.2. Выполнение работы***

**1**

**4.2.1. Настройка сервера Samba**

Устанавливаю необходимые пакеты

Создаю группу для пользователей, которые будут работать с этим

сервисом

Добавляю пользователя к группе и создаю каталог

В файл конфигурации добавляю записи

Команды для проверки у меня не было, поэтому я ее устанавливала

Настрою межсетевой экран

Настрою права доступа

Настрою контекст безопасности

Настраиваю контекст безопасности SELinux для каталога с разделяемым

ресурсом:

Проведу проверку, что контекст безопасности изменился и разрешаю

экспортировать разделяемые ресурсы

Посмотрю UID пользователя

Создаю файл

Добавляю пользователя в базу и ввожу пароль

**1**

**4.2.2. Монтирование файловой системы Samba на клиенте**

Устанавливаю необходимые пакеты

Настраиваю межсетевой экран:

Создаю группу и добавляю в нее пользователя

В файле конфигурации изменяю запись

***Чтобы проверить, попробую подключиться к серверу***

***Итог:*** все успешно

Создаю точку монтирования и добавляю записи:

Создаю файл

Протестировала на автоматическое монтирование

**1**

**4.3.3. Внесение изменений в настройки внутреннего**

**окружения виртуальных машин**

Создаю файл smb.sh

Добавлю записи в Vagrantfile

***1***

***4.3. Итог работы***

**1**

**. Изменение аппаратных характеристик ВМ:**

Освоены методы динамического изменения объёма оперативной памяти

(RAM) и количества виртуальных процессорных ядер (vCPU) без полной

остановки виртуальной машины (с использованием \"горячего\" добавления

ресурсов, где это поддерживается гипервизором).

Отработано увеличение и уменьшение виртуальных дисков с

использованием утилит гипервизора (например, qemu-img, virt-resize) с

последующим расширением файловых систем внутри гостевой ОС.

**2**

**. Настройка виртуальных сетевых интерфейсов:**

Добавлены, удалены и изменены параметры виртуальных сетевых

адаптеров (тип адаптера, привязка к виртуальным сетям, MAC-адреса).

Настроена маршрутизация и параметры сетевых интерфейсов внутри

гостевой ОС для соответствия изменениям в конфигурации виртуальной

сети.

**3**

**. Управление виртуальными носителями:**

Подключение и отключение виртуальных CD/DVD-приводов с ISO-

образами для установки ПО или обновлений.

Изменение порядка загрузки (boot order) в BIOS/UEFI виртуальной

машины.

**4**

**. Работа с конфигурационными файлами ВМ:**

Изучен формат конфигурационных файлов гипервизора (например, XML-

файлы libvirt).

Отработано редактирование этих файлов для тонкой настройки

параметров ВМ: изменение таймеров, включение/отключение функций

виртуализации (KVM, nested virtualization), настройка контроллеров
ввода-

вывода.

**5**

**. Применение изменений и валидация:**

Освоены процедуры безопасного применения изменений (graceful

shutdown, приостановка, live migration для критичных ВМ).

Проверена работоспособность ВМ после внесения изменений через

мониторинг производительности и анализ логов гостевой и хостовой

систем.

**6**

**. Автоматизация изменений:**

Использованы скрипты и инструменты командной строки (например, virsh

для libvirt) для автоматического внесения однотипных изменений в

группы виртуальных машин.

Созданы шаблоны конфигураций для быстрого развёртывания ВМ с

типовыми параметрами.

**7**

**. Диагностика и решение проблем:**

Выявлены и устранены типичные проблемы:

конфликты ресурсов, ошибки при изменении размера диска, сброс сетевых

настроек после изменения адаптера.

Отработано использование инструментов отладки гипервизора и гостевых

систем.

**Вывод**:

В результате выполнения работы сформированы устойчивые навыки

управления внутренним окружением виртуальных машин, что позволяет

гибко адаптировать инфраструктуру виртуализации под изменяющиеся

требования нагрузок и сервисов.

Приобретённые компетенции включают не только техническое внесение

изменений, но и понимание их влияния на производительность и

стабильность, а также владение лучшими практиками для минимизации

downtime.

Эти умения являются ключевыми для администраторов облачных сред и

инфраструктур виртуализации.

***1***

***4.4 Контрольные вопросы***

**1**

**. Минимальная конфигурация smb.conf для создания общего**

**ресурса, предоставляющего доступ к каталогу /data:**

Для создания базового общего ресурса в файле /etc/samba/smb.conf

необходимо добавить секцию с описанием ресурса.

Минимальная конфигурация включает указание пути к каталогу и базовые

права доступа. Пример:

path = /data

browseable = yes

writable = no

guest ok = no

В данном примере создаётся ресурс с именем DataShare, указывающий на

каталог /data. Ресурс виден в списке общих папок (browseable = yes),
запись

по умолчанию запрещена (writable = no), а гостевой доступ отключён
(guest

ok = no). Для применения изменений требуется перезапустить службу Samba.

**2**

**. Настройка общего ресурса с доступом на запись для всех**

**пользователей, имеющих соответствующие права в файловой**

**системе Linux:**

Чтобы предоставить доступ на запись всем пользователям, которые имеют

права записи в соответствующем каталоге файловой системы Linux,

используется параметр write list со специальным значением.

Конфигурация будет выглядеть так:

path = /shared_data

browseable = yes

writable = no

write list = \@users

Здесь \@users указывает на системную группу users. Все пользователи,

входящие в эту группу и имеющие права на запись в каталоге /shared_data

на уровне файловой системы, смогут записывать данные через Samba.

Важно согласовать права Linux (chmod) и членство в группах.

**3**

**. Ограничение доступа на запись к ресурсу только для**

**членов определённой группы:**

**Для ограничения записи членами конкретной группы**

**(например, developers) используется параметр write list с**

**указанием группы:**

path = /dev_data

browseable = yes

writable = no

valid users = \@developers

write list = \@developers

Данная конфигурация разрешает доступ к ресурсу только пользователям

из группы developers (valid users = \@developers), и только они же имеют

права на запись (write list = \@developers). Остальные пользователи не

смогут даже увидеть или подключиться к ресурсу.

**4**

**. Переключатель SELinux для разрешения доступа**

**пользователей к домашним каталогам через SMB:**

В системах с включённым SELinux для разрешения доступа к домашним

каталогам по протоколу SMB необходимо установить соответствующий

логический переключатель (boolean) samba_enable_home_dirs.

Это делается командой:

setsebool -P samba_enable_home_dirs on

Ключ -P делает изменение постоянным (сохраняется после перезагрузки).

Данный переключатель разрешает демону Samba читать и записывать

данные в домашних каталогах пользователей, которые по умолчанию

имеют контекст безопасности user_home_dir_t.

**5**

**. Ограничение доступа к ресурсу только для узлов из сети**

**1**

**92.168.10.0/24:**

Чтобы разрешить подключение к общему ресурсу только с определённой

подсети, используется параметр hosts allow в секции ресурса или в

глобальной секции \[global\].

**6**

**. Команда для отображения списка всех пользователей**

**Samba на сервере**

Для просмотра списка пользователей, зарегистрированных в базе Samba

(отдельной от системной), используется утилита pdbedit.

**7**

**. Действия пользователя для доступа к ресурсу,**

**настроенному как многопользовательский:**

Многопользовательский ресурс (параметр multiuser = yes) предназначен

для использования в сочетании с клиентскими ОС, поддерживающими

функцию multiuser (например, Android, некоторые дистрибутивы Linux).

**8**

**. Настройка общего ресурса Samba в качестве**

**многопользовательского с использованием пользователя**

**alice в качестве минимальной учётной записи:**

Для настройки многопользовательского ресурса с минимальной учётной

записью alice в конфигурацию добавляются параметры:

\]

path = /multiuser_data

browseable = yes

multiuser = yes

guest ok = yes

guest only = yes

guest account = alice

Здесь multiuser = yes активирует многопользовательский режим. guest ok =

yes и guest only = yes разрешают и требуют гостевой доступ для

первоначального монтирования. guest account = alice указывает, что все

гостевые подключения будут использовать права системного пользователя

alice для начального доступа к файловой системе. Фактические права

доступа к файлам определяются после повторной аутентификации через

cifscreds.

**9**

**. Запрет пользователям просматривать учётные данные**

**монтирования Samba в файле /etc/fstab:**

Для предотвращения хранения паролей в открытом виде в /etc/fstab

следует использовать файл учётных данных (credentials file).

**1**

**0. Команда для перечисления всех экспортируемых ресурсов**

**Samba на определённом сервере:**

Для просмотра списка общих ресурсов, предоставляемых Samba-сервером,

используется утилита smbclient в режиме запроса списка:

smbclient -L //servername -U%

Ключ -L запрашивает список ресурсов, //servername --- имя или IP-адрес

сервера, а -U% указывает на анонимный запрос (без аутентификации).

Если для просмотра списка требуется аутентификация, вместо %

указывается имя пользователя: -U username. Альтернативно можно

использовать nmblookup или smbtree для сетевого обнаружения ресурсов.
